Let $\mathcal{S}$ be a nonempty semigroup endowed with a binary associative operation $*$. An element
$e$ of $\mathcal{S}$ is said to be idempotent if $e*e=e$. Originated by one question of P. Erd\H{o}s
to D.A. Burgess: {\sl `If $\mathcal{S}$ is a finite semigroup of order $n$, does any $\mathcal{S}$-valued
sequence $T$ of length $n$ contain a nonempty subsequence the product of whose terms, in some order,
is idempotent?'}, we make a study of the associated invariant, denoted ${\rm I}(\mathcal{S})$
and called Erd\H{o}s-Burgess constant which is the smallest positive integer $\ell$ such that
any $\mathcal{S}$-valued sequence $T$ of length $\ell$ contain a nonempty subsequence the product
of whose terms, in any order, is an idempotent. We obtain conditions such that the Erd\H{o}s-Burgess
constant is finite for the multiplicative semigroup of any commutative unitary ring. As a corollary,
we derive that the corresponding Erd\H{o}s-Burgess constant is finite if and only if the ring is
finite for any Noetherian ring. When $\mathcal{S}$ is a direct product of arbitrarily many of cyclic
semigroups, we give the necessary and sufficient conditions of ${\rm I}(\mathcal{S})$ being finite,
and in particular, we give sharp lower and upper bounds of ${\rm I}(\mathcal{S})$ in case ${\rm I}(\mathcal{S})$
is finite. Moreover, we determine the precise values of ${\rm I}(\mathcal{S})$ in some cases. Also,
we characterize the structure of long sequences which contains no nonempty subsequence with that
property in the case when $\mathcal{S}$ is a cyclic semigroup. 