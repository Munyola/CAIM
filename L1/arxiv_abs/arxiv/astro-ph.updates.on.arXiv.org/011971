We extend the internal template foreground removal method by accounting for spatially varying
spectral parameters such as the spectral indices of synchrotron and dust emission and the dust temperature.
As the previous algorithm had to assume that the spectral parameters are uniform over the full sky
(or some significant fraction of the sky), it resulted in a bias in the tensor-to-scalar ratio parameter
$r$ estimated from foreground-cleaned polarization maps of the cosmic microwave background (CMB).
The new algorithm, "Delta-map method", accounts for spatially varying spectra to first order in
perturbation. The only free parameters are the cosmological parameters such as $r$ and the sky-averaged
foreground parameters. We show that a cleaned CMB map is the maximum likelihood solution to first
order in perturbation, and derive the posterior distribution of $r$ and the sky-averaged foreground
parameters using Bayesian statistics. Applying this to realistic simulated sky maps including
polarized CMB, synchrotron and thermal dust emission, we find that the new algorithm removes the
bias in $r$ down to undetected level in our noiseless simulation ($r\lesssim 4\times 10^{-4}$).
We show that the frequency decorrelation of polarized foregrounds due to averaging of spatially
varying spectra can be accounted for to first order in perturbation by using slightly different
spectral parameters for the Stokes $Q$ and $U$ maps. Finally, we show that the effect of polarized
anomalous microwave emission on foreground removal can be absorbed into the curvature parameter
of the synchrotron spectrum. 