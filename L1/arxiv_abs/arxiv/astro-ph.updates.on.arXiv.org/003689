We use two cosmological simulations of structure formation in the LambdaCDM scenario to study the
evolutionary histories of dark-matter haloes and to characterize the Lagrangian regions from
which they form. We focus on haloes identified at redshift z_id=0 and show that the classic ellipsoidal
collapse model systematically overestimates their collapse times. If one imposes that halo collapse
takes place at z_id, this model requires starting from a significantly lower linear density contrast
than what is measured in the simulations at the locations of halo formation. We attempt to explain
this discrepancy by testing two key assumptions of the model. First, we show that the tides felt by
collapsing haloes due to the surrounding large-scale structure evolve non-linearly. Although
this effect becomes increasingly important for low-mass haloes, accounting for it in the ellipsoidal
collapse model only marginally improves the agreement with N-body simulations. Second, we track
the time evolution of the physical volume occupied by forming haloes and show that, after turnaround,
it generally stabilizes at a well-defined redshift, z_c>z_id, contrary to the basic assumption
of extended Press-Schechter theory based on excursion sets. We discuss the implications of this
result for understanding the origin of the mass-dependence and scatter in the linear threshold
for halo formation. Finally, we show that, when tuned for collapse at z_c, a modified version of the
ellipsoidal collapse model that also accounts for the triaxial nature of protohaloes predicts
their linear density contrast in an unbiased way. 