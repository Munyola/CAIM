We consider the moduli space of holomorphic principal bundles for reductive Lie groups over Riemann
surfaces (possibly with boundaries) and equipped with meromorphic connections. We associate
to this space a point-wise notion of quantum spectral curve whose generalized periods define a new
set of moduli. We define homology cycles and differential forms of the quantum spectral curve, allowing
to derive quantum analogs of the form-cycle duality and Riemann bilinear identities of classical
geometry. A tau-function is introduced for this system in the form of a theta-series and in such a
way that the variations of its coefficients with respect to moduli, isomonodromic or not, can be
computed as quantum period integrals. This lays new grounds to relate our study to that of integrable
hierarchies, isomonodromic deformation of meromorphic connections and non-perturbative topological
string theory. In turn, we define amplitudes on the quantum spectral curve which have an interpretation
in conformal field theory when the Lie algebra is assumed to be simply-laced: they coincide with
correlation functions involving twisted chiral fields of an affine Lie algebra at level one. The
singularities at the punctures are interpreted as primary fields of the associated Casimir W-algebra.
The amplitudes are moreover related by W-constraints, so-called loop equations, allowing one
to compute recursively a certain asymptotic expansion of the tau-function, namely the one corresponding
both to the heavy-charge regime of conformal field theory and to the weak-coupling regime of topological
string theory. 